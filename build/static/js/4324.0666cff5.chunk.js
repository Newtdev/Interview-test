"use strict";(self.webpackChunkkrext=self.webpackChunkkrext||[]).push([[4324],{6524:function(e,l,t){t.d(l,{Z:function(){return n}});var a=t(46417);function n(e){var l=e.name,t=e.children,n=e.options;return(0,a.jsxs)("div",{className:"w-full px-6 pb-4 bg-white shadow h-fit rounded-2xl",children:[(0,a.jsxs)("div",{className:"flex flex-row justify-between items-center py-6 text-base font-bold border-b",children:[(0,a.jsx)("h4",{children:l}),(0,a.jsx)("div",{children:n})]}),t]})}},39144:function(e,l,t){var a=t(81676),n=(t(47313),t(46417));l.Z=function(e){var l=e.type;return(0,n.jsx)("span",{children:l===a.t0.GREATER_THAN?">":l===a.t0.LESS_THAN?"<":l===a.t0.EQUALS?"=":l===a.t0.BETWEEN?"><":null})}},4593:function(e,l,t){t.d(l,{Z:function(){return y}});var a=t(74165),n=t(1413),i=t(93433),s=t(15861),r=t(29439),d=t(47313),o=t(27181),u=t(19536),c=t(71034),v=t(31271),x=t(25376),m=t(36059),p=t(92197),h=t(3051),f=t(89434),j=t(81676),b=t(40086),g=t(46417);function y(e){var l,t,y,w=e.metricData,Z=e.isOpen,N=e.closeModal,_=(e.handleAction,(0,b.Z)().user),M=(0,d.useState)(),k=(0,r.Z)(M,2),C=k[0],E=k[1],A=(0,d.useMemo)((function(){return w.data.values.find((function(e){var l=(0,p.default)(w.date,"dd-MM-yyyy",new Date);return(0,h.default)(new Date(e.updated_at),l)}))}),[w]),P=(0,v.Z)().toggleLoadingModal,T=x.t.useUpdateMetricsSpecificValueMutation(),U=(0,r.Z)(T,1)[0],D=function(){var e=(0,s.Z)((0,a.Z)().mark((function e(){var l,t,s;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return P(!0),e.prev=1,l=A?w.data.values.map((function(e){return(0,h.default)(new Date(e.updated_at),(0,p.default)(w.date,"dd-MM-yyyy",new Date))?(0,n.Z)((0,n.Z)({},e),{},{value:C,updated_by:_.id}):e})):[].concat((0,i.Z)(null===w||void 0===w?void 0:w.data.values),[{value:C,updated_at:(0,p.default)(w.date,"dd-MM-yyyy",new Date),updated_by:_.id}]),e.next=5,U({id:w.data.id,values:l}).unwrap();case 5:t=e.sent,m.ZP.success((null===t||void 0===t?void 0:t.message)||"Updated"),N(),e.next=15;break;case 10:e.prev=10,e.t0=e.catch(1),console.log(e.t0,"Error Updating value"),P(!1),m.ZP.error(null===e.t0||void 0===e.t0||null===(s=e.t0.data)||void 0===s?void 0:s.message);case 15:P(!1);case 16:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(){return e.apply(this,arguments)}}();return(0,g.jsx)(o.Z,{open:Z,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:(0,g.jsx)(c.Z,{children:(0,g.jsx)("div",{className:"relative w-2/6 max-w-2xl max-h-full",children:(0,g.jsxs)("div",{className:"relative bg-white rounded-lg shadow",children:[(0,g.jsxs)("div",{className:"flex items-start justify-between p-4 border-b rounded-t",children:[(0,g.jsx)("h3",{className:"text-xl font-semibold text-primary-dark",children:"Update  ".concat(null===w||void 0===w||null===(l=w.data)||void 0===l?void 0:l.title," ")}),(0,g.jsxs)("button",{onClick:N,type:"button",className:"inline-flex items-center justify-center w-8 h-8 ml-auto text-sm text-gray-400 bg-transparent rounded-lg hover:bg-gray-200 hover:text-gray-900 ","data-modal-hide":"defaultModal",children:[(0,g.jsx)("svg",{className:"w-3 h-3","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"red",viewBox:"0 0 14 14",children:(0,g.jsx)("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"})}),(0,g.jsx)("span",{className:"sr-only",children:"Close modal"})]})]}),(0,g.jsxs)("div",{className:"p-6 space-y-6",children:[(0,g.jsxs)("div",{className:"flex flex-col w-full space-y-2 ",children:[(0,g.jsx)(u.Z,{}),(0,g.jsxs)("div",{className:"flex flex-row justify-between",children:[(0,g.jsx)("span",{children:"Assignee"}),(0,g.jsx)("span",{className:"flex flex-row text-sm text-primary",children:(null===(t=w.data)||void 0===t||null===(y=t.assignee)||void 0===y?void 0:y.email)||"-----"})]}),(0,g.jsx)(u.Z,{}),(0,g.jsxs)("div",{className:"flex flex-row justify-between",children:[(0,g.jsx)("span",{children:"Metric Goal"}),(0,g.jsxs)("span",{className:"flex flex-row text-sm text-primary",children:[(0,g.jsx)("p",{children:w.data.unit===j.JA.CURRENCY?"$":""})," ",w.data.value||"---"," ",(0,g.jsx)("p",{children:w.data.unit===j.JA.PERCENTAGE?" %":""})]})]}),(0,g.jsx)(u.Z,{}),(0,g.jsxs)("div",{className:"flex flex-row justify-between",children:[(0,g.jsx)("span",{children:"Date Recorded"}),(0,g.jsx)("span",{className:"text-sm text-primary",children:null!==A&&void 0!==A&&A.updated_at?(0,f.default)(new Date(null===A||void 0===A?void 0:A.updated_at),"MMM-dd-yyyy"):"---"})]}),(0,g.jsx)(u.Z,{}),(0,g.jsxs)("div",{className:"flex flex-row justify-between",children:[(0,g.jsx)("span",{className:"font-bold",children:"Previous Value"}),(0,g.jsx)("span",{className:"text-lg font-bold",children:(null===A||void 0===A?void 0:A.value)||"--"})]}),(0,g.jsx)(u.Z,{}),(0,g.jsxs)("div",{className:"flex flex-row justify-between",children:[(0,g.jsx)("span",{className:"font-bold",children:"Current Value"}),(0,g.jsx)("span",{className:"text-lg font-bold",children:C||"0"})]})]}),(0,g.jsx)("div",{className:"flex flex-row justify-center p-2 ",children:(0,g.jsx)("div",{className:"flex flex-row items-center justify-center px-2 border-2 w-[100px] border-gray-400",children:(0,g.jsx)("input",{id:"value",className:"h-full bg-inherit text-sm rounded placeholder:text-sm w-[75px] p-3 outline-none justify-center items-center",type:"number",value:C,onChange:function(e){var l=e.target.value,t=parseInt(l,10);isNaN(t)?E(0):E(t)}})})})]}),(0,g.jsxs)("div",{className:"flex flex-row items-center justify-around p-6 space-x-2 border-t border-gray-200 rounded-b dark:border-gray-600",children:[(0,g.jsx)("button",{"data-modal-hide":"defaultModal",type:"button",className:"text-white bg-primary hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center",onClick:function(e){e.preventDefault(),D()},children:"Update Record"}),(0,g.jsx)("button",{onClick:N,"data-modal-hide":"defaultModal",type:"button",className:"text-gray-500 bg-white hover:bg-gray-100 focus:ring-4 focus:outline-none focus:ring-blue-300 rounded-lg border border-gray-200 text-sm font-medium px-5 py-2.5 hover:text-gray-900 focus:z-10",children:"Cancel"})]})]})})})})}},47889:function(e,l,t){t.d(l,{Z:function(){return A}});var a=t(74165),n=t(1413),i=t(45987),s=t(15861),r=t(29439),d=t(47313),o=t(79429),u=t(97931),c=t(27356),v=t(57406),x=t(21933),m=t(1550),p=t(16429),h=t(52866),f=t(44758),j=t(31271),b=t(36059),g=t(96215),y=t(25376),w=t(48475),Z=t(82101),N=t(40086),_=t(61171),M=t(81676),k=t(35925),C=t(46417),E=["assignee"];function A(e){var l,t,A,P,T,U,D,S,W,O,R,q,V,G,L,I,B,J,Q,F=e.show,H=e.handleToggleGoal,z=e.itemData,Y=(0,N.Z)().user,$=(0,j.Z)().toggleLoadingModal,K=y.t.useUpdateMetricsMutation(),X=(0,r.Z)(K,1)[0],ee=_.W.useMeetingParticipantsQuery({meeting:null===z||void 0===z||null===(l=z.meeting)||void 0===l?void 0:l._id},{skip:!(null!==z&&void 0!==z&&null!==(t=z.meeting)&&void 0!==t&&t._id)}),le=(0,d.useMemo)((function(){var e;return(null===ee||void 0===ee||null===(e=ee.data)||void 0===e?void 0:e.data)||[]}),[ee]),te=(0,o.TA)({initialValues:{title:null===z||void 0===z?void 0:z.title,details:null===z||void 0===z?void 0:z.details,unit:null===z||void 0===z?void 0:z.unit,value:null===z||void 0===z?void 0:z.value,type:null===z||void 0===z?void 0:z.type,assignee:(null===z||void 0===z||null===(A=z.assignee_full)||void 0===A?void 0:A._id)||"",meeting:(null===z||void 0===z||null===(P=z.meeting)||void 0===P?void 0:P._id)||"",controls:null===z||void 0===z?void 0:z.controls},validateOnChange:!0,validateOnBlur:!0,validationSchema:x.Ry().shape({title:x.Z_().label("Metric Title").required(),details:x.Z_().label("Details").optional(),assignee:x.Z_().label("Assignee").required(),meeting:x.Z_().label("Meeting").required(),unit:x.Z_().label("Unit").oneOf(Object.values(M.JA)).required(),value:x.Z_().label("Value").required(),type:x.Z_().oneOf(Object.values(M.qT)).label("Metric type").required()}),onSubmit:function(){var e=(0,s.Z)((0,a.Z)().mark((function e(l){var t,s,r,d;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l.assignee,t=(0,i.Z)(l,E),$(!0),e.prev=2,e.next=5,X((0,n.Z)((0,n.Z)({},t),{},{id:null===z||void 0===z?void 0:z.id})).unwrap();case 5:r=e.sent,H(),b.ZP.success(null===r||void 0===r?void 0:r.message),(0,w.T)({channel:Z.vI.MEETING_SESSION_MODULE_UPDATE,data:{event:M.G9.METRIC,user_id:null===Y||void 0===Y?void 0:Y.id,room_name:null===z||void 0===z||null===(s=z.meeting)||void 0===s?void 0:s._id}}),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(2),$(!1),b.ZP.error(null===e.t0||void 0===e.t0||null===(d=e.t0.data)||void 0===d?void 0:d.message);case 15:$(!1);case 16:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(l){return e.apply(this,arguments)}}()});console.log(te.errors);var ae=_.W.useUserMeetingsQuery({}),ne=(0,d.useMemo)((function(){var e;return null===ae||void 0===ae||null===(e=ae.data)||void 0===e?void 0:e.data}),[ae]);return(0,C.jsx)("section",{children:(0,C.jsx)("article",{children:(0,C.jsx)(g.Z,{open:F,name:"".concat(z.title),handleToggleDrawer:H,children:(0,C.jsx)("div",{className:"px-4",children:(0,C.jsxs)("form",{onSubmit:te.handleSubmit,children:[(0,C.jsx)("div",{children:(0,C.jsx)(c.Z,(0,n.Z)({type:"text",placeholder:"Name"},(0,v.PW)(te,"title")))}),(0,C.jsx)("div",{className:"h-full mt-4 overflow-hidden ",children:(0,C.jsx)(u.ML,{value:null===(T=te.values)||void 0===T?void 0:T.details,handleChange:function(e){return te.setFieldValue("details",e.replace(/<[^>]*>/g,""))},className:"w-full h-40",placeholder:"Goal details...."})}),(0,C.jsxs)("div",{className:"grid content-center grid-cols-2 my-4 mt-6 gap-x-4",children:[(0,C.jsx)(k.Z,{loading:null===ae||void 0===ae?void 0:ae.isLoading,error:null===ae||void 0===ae?void 0:ae.isError,onReload:null===ae||void 0===ae?void 0:ae.refetch,children:function(){var e,l;return(0,C.jsxs)("div",{className:"relative ",children:[(0,C.jsx)("span",{className:"text-gray-400 text-[10px] absolute ml-4 mt-1",children:"Meeting"}),(0,C.jsx)("select",(0,n.Z)((0,n.Z)({className:"w-full p-4 border border-black rounded-md",placeholder:"Meeting",value:null===(e=te.values)||void 0===e?void 0:e.meeting},(0,v.PW)(te,"meeting")),{},{children:null===ne||void 0===ne?void 0:ne.map((function(e){return(0,C.jsx)("option",{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.title},null===e||void 0===e?void 0:e._id)}))})),null!==te&&void 0!==te&&null!==(l=te.errors)&&void 0!==l&&l.meeting?(0,C.jsx)("span",{className:"text-[10px] text-error",children:te.errors.meeting}):null]})}}),(0,C.jsxs)("div",{className:"relative",children:[(0,C.jsx)("span",{className:"text-gray-400 text-[10px] absolute ml-4 mt-1",children:"Assignee"}),(0,C.jsx)("select",(0,n.Z)((0,n.Z)({className:"w-full p-4 border border-black rounded-md",placeholder:"Assignee",value:null===(U=te.values)||void 0===U?void 0:U.assignee},(0,v.PW)(te,"assignee")),{},{children:le.map((function(e){var l,t;return(0,C.jsx)("option",{value:null===(l=e.participant)||void 0===l?void 0:l._id,children:null===(t=e.participant)||void 0===t?void 0:t.email},null===e||void 0===e?void 0:e._id)}))})),null!==te&&void 0!==te&&null!==(D=te.errors)&&void 0!==D&&D.assignee?(0,C.jsx)("span",{className:"text-[10px] text-error",children:te.errors.assignee}):null]})]}),(0,C.jsxs)("div",{className:"relative my-4 ",children:[(0,C.jsx)("span",{className:"text-gray-400 text-[10px] absolute ml-4 mt-1",children:"Unit"}),(0,C.jsx)("select",(0,n.Z)((0,n.Z)({className:"w-full p-4 border border-black rounded-md",placeholder:"Unit",value:null===(S=te.values)||void 0===S?void 0:S.unit},(0,v.PW)(te,"unit")),{},{children:null===(W=Object.values(M.JA))||void 0===W?void 0:W.map((function(e){return(0,C.jsx)("option",{value:e,children:(0,v.fm)(e)},e)}))})),null!==te&&void 0!==te&&null!==(O=te.errors)&&void 0!==O&&O.unit?(0,C.jsx)("span",{className:"text-[10px] text-error",children:te.errors.unit}):null]}),(0,C.jsxs)("div",{className:"grid grid-cols-2 gap-4 py-4 mt-1 ",children:[(0,C.jsxs)("div",{className:"relative ",children:[(0,C.jsx)("span",{className:"text-gray-400 text-[10px] absolute ml-4 mt-1",children:"Type"}),(0,C.jsx)("select",(0,n.Z)((0,n.Z)({className:"w-full p-4 border border-black rounded-md",placeholder:"Type",value:null===(R=te.values)||void 0===R?void 0:R.type},(0,v.PW)(te,"type")),{},{children:null===(q=Object.values(M.qT))||void 0===q?void 0:q.map((function(e){return(0,C.jsx)("option",{value:e,children:(0,v.fm)(null===e||void 0===e?void 0:e.replace("_"," "))},e)}))})),null!==te&&void 0!==te&&null!==(V=te.errors)&&void 0!==V&&V.type?(0,C.jsx)("span",{className:"text-[10px] text-error",children:te.errors.type}):null]}),(0,C.jsx)(c.Z,(0,n.Z)({type:"text",showBreak:!1,placeholder:"Value"},(0,v.PW)(te,"value")))]}),(0,C.jsx)("div",{className:"flex h-full mt-6",children:(0,C.jsxs)(m.Z,{component:"fieldset",variant:"standard",children:[(0,C.jsx)("label",{className:"mb-2 font-bold text-black",children:"Advanced controls"}),(0,C.jsxs)(p.Z,{children:[(0,C.jsx)(h.Z,{control:(0,C.jsx)(f.Z,(0,n.Z)({checked:null===(G=te.values)||void 0===G||null===(L=G.controls)||void 0===L?void 0:L.is_show_average},(0,v.PW)(te,"controls.is_show_average"))),label:"Show Average"}),(0,C.jsx)(h.Z,{control:(0,C.jsx)(f.Z,(0,n.Z)({checked:null===(I=te.values)||void 0===I||null===(B=I.controls)||void 0===B?void 0:B.is_formula},(0,v.PW)(te,"controls.is_formula"))),label:"Formula"}),(0,C.jsx)(h.Z,{control:(0,C.jsx)(f.Z,(0,n.Z)({checked:null===(J=te.values)||void 0===J||null===(Q=J.controls)||void 0===Q?void 0:Q.is_show_cumulative},(0,v.PW)(te,"controls.is_show_cumulative"))),label:"Show Cumulative"})]})]})}),(0,C.jsxs)("div",{className:"grid grid-cols-2 gap-x-4",children:[(0,C.jsx)("button",{type:"button",onClick:H,className:"flex items-center justify-center w-full px-3 py-4 mt-12 mb-3 text-base ease-linear delay-100 border rounded-lg text-primary border-primary hover:bg-blue-800 hover:text-white",children:"Cancel"}),(0,C.jsx)("button",{disabled:!te.isValid,type:"submit",className:"flex items-center justify-center w-full px-3 py-4 mt-12 mb-3 text-base text-white ease-linear delay-100 rounded-lg bg-primary hover:bg-blue-800",children:"Update"})]})]})})})})})}}}]);